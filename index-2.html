<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Real-Time Chat</title>
<style>
body { font-family: Arial; display:flex; justify-content:center; align-items:center; height:100vh; background:#f5f5f5; margin:0; }
#login-container, #chat-container { background:#fff; padding:20px; border-radius:10px; width:400px; box-shadow:0 0 10px rgba(0,0,0,0.1); }
#messages { border:1px solid #ccc; height:300px; overflow-y:scroll; padding:10px; margin-bottom:10px; background:#fafafa; }
#messages div { margin-bottom:8px; }
input[type="text"], input[type="password"] { width:100%; padding:8px; margin-bottom:10px; border-radius:5px; border:1px solid #ccc; }
button { padding:8px 12px; margin-right:5px; border:none; border-radius:5px; background:#4CAF50; color:white; cursor:pointer; }
button:hover { background:#45a049; }
</style>
</head>
<body>
<div id="login-container">
<h2>Login / Register</h2>
<input type="text" id="username" placeholder="Username"><br>
<input type="password" id="password" placeholder="Password"><br>
<button onclick="register()">Register</button>
<button onclick="login()">Login</button>
</div>
<div id="chat-container" style="display:none;">
<h2>Group Chat</h2>
<div id="messages"></div>
<input type="text" id="messageInput" placeholder="Type a message" onkeydown="if(event.key==='Enter'){sendMessage()}">
<button onclick="sendMessage()">Send</button>
</div>
<script src="https://cdn.socket.io/4.7.1/socket.io.min.js"></script>
<script>
const socket = io('http://localhost:5000');
let username = '';
const loginContainer = document.getElementById('login-container');
const chatContainer = document.getElementById('chat-container');
const messagesDiv = document.getElementById('messages');
const messageInput = document.getElementById('messageInput');
function register() {
  username = document.getElementById('username').value;
  const password = document.getElementById('password').value;
  fetch('http://localhost:5000/register', { method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({username,password}) })
    .then(res=>res.json()).then(data=>alert(data.message)).catch(err=>alert(err));
}
function login() {
  username = document.getElementById('username').value;
  const password = document.getElementById('password').value;
  fetch('http://localhost:5000/login', { method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({username,password}) })
    .then(res=>res.json()).then(data=>{ if(data.message==='Login successful'){ loginContainer.style.display='none'; chatContainer.style.display='block'; } else { alert(data.message); } }).catch(err=>alert(err));
}
function sendMessage(){ const message = messageInput.value; if(message.trim()!==''){ socket.emit('sendMessage',{username,message}); messageInput.value=''; } }
socket.on('receiveMessage', data=>{ const div=document.createElement('div'); div.innerHTML=`<b>${data.username}:</b> ${data.message}`; messagesDiv.appendChild(div); messagesDiv.scrollTop=messagesDiv.scrollHeight; });
socket.on('previousMessages', msgs=>{ msgs.forEach(msg=>{ const div=document.createElement('div'); div.innerHTML=`<b>${msg.username}:</b> ${msg.message}`; messagesDiv.appendChild(div); }); messagesDiv.scrollTop=messagesDiv.scrollHeight; });
</script>
</body>
</html>
